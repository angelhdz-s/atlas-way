generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// MARK: User Plan

model User {
  id            String        @id @default(cuid())
  email         String        @unique
  name          String
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  routines      Routine[]
  sessions      Session[]
  exercises     Excercise[]
  notifications Notifications[]
  tracking      Tracking[]
}

model Routine {
  id            Int             @id @default(autoincrement())
  userId        String
  active        Boolean         @default(true)
  name          String          @unique
  description   String?
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt
  user          User            @relation(fields: [userId], references: [id])
  sessions      Session[]
}

model Session {
  id            Int           @id @default(autoincrement())
  userId        String
  name          String        @unique
  description   String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  user          User          @relation(fields: [userId], references: [id])
  routines      Routine[]
  exercises     Excercise[]
}

model Excercise {
  id            Int           @id @default(autoincrement())
  userId        String
  name          String        
  description   String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  user          User          @relation(fields: [userId], references: [id])
  sessions      Session[]
  muscles       Muscle[]
  initialStats  ExcerciseInitialStats?
  trackedExercise TrackedExercise[]
}

model ExcerciseInitialStats {
  id            Int           @id @default(autoincrement())
  exerciseId    Int           @unique
  sets          Int
  reps          Int
  weight        Int
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  exercise      Excercise     @relation(fields: [exerciseId], references: [id])
}

// MARK: System tables

model Notifications {
  id              Int                 @id @default(autoincrement())
  userId          String
  name            String              
  message         String
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  user            User                @relation(fields: [userId], references: [id])
}

model Status {
  id              String              @id
  name            String              @unique
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  tracking        Tracking[]
}

model DayType {
  id              String              @id
  name            String              @unique
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  tracking        Tracking[]
}

model BodySection {
  id              Int                 @id @default(autoincrement())
  name            String              @unique
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt
  muscularGroups  MuscularGroup[]
}

model MuscularGroup {
  id            Int         @id @default(autoincrement())
  bodySectionId Int
  name          String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  bodySection   BodySection @relation(fields: [bodySectionId], references: [id])
  muscles       Muscle[]
}

model Muscle {
  id              Int           @id @default(autoincrement())
  muscularGroupId Int
  name            String
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  muscularGroup   MuscularGroup @relation(fields: [muscularGroupId], references: [id])
  exercises       Excercise[]
}

// MARK: Tracking tables

model Tracking {
  id                    Int                 @id @default(autoincrement())
  userId                String
  status                String
  dayType               String
  notes                 String?
  createdAt             DateTime            @default(now())
  updatedAt             DateTime            @updatedAt
  user                  User                @relation(fields: [userId], references: [id])
  fkStatus              Status              @relation(fields: [status], references: [id])
  fkDayType             DayType             @relation(fields: [dayType], references: [id])
  trackedExercise       TrackedExercise[]
}

model TrackedExercise {
  id                      Int                       @id @default(autoincrement())
  trackingId              Int
  exerciseId              Int                      
  sets                    Int
  reps                    Int
  weight                  Int
  createdAt               DateTime                  @default(now())
  updatedAt               DateTime                  @updatedAt
  tracking                Tracking                  @relation(fields: [trackingId], references: [id])
  exercise                Excercise                 @relation(fields: [exerciseId], references: [id])
  trackedExerciseStats    TrackedExerciseStats?
}

model TrackedExerciseStats {
  id                  Int                 @id @default(autoincrement())
  trackedExerciseId   Int                 @unique
  sets                Int
  reps                Int
  weight              Int
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  trackedExercise     TrackedExercise     @relation(fields: [trackedExerciseId], references: [id])
}